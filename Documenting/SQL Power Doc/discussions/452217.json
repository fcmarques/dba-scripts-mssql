[
  {
    "Id": "1075946",
    "ThreadId": "452217",
    "Html": "Hello,<br />\n<br />\nI tried to run the script against a SQL Server Cluster. <br />\n<pre><code>.\\Get-SqlServerInventoryToClixml.ps1 -ComputerName CLUSTERNAME</code></pre>\n\nDuring the script is running, I get an error. It seems that the script tries to connect to the active node directly, which isn't working.<br />\n<pre><code>WARNING: Failed to connect to ACTIVENODE\nWARNING: Failed to connect to ACTIVENODE\nWARNING: Failed to connect to ACTIVENODE\nWARNING: [ACTIVENODE] Error gathering instance information - max error threshold reached (3)\nWrite-Log : Failed to scan ACTIVENODE -  3 errors\nAt C:\\Users\\fox0ogk-adm\\Documents\\WindowsPowerShell\\Modules\\SqlServerInventory\\SqlServerInventory.psm1:275 char:13\n+             Write-Log &lt;&lt;&lt;&lt;  -Message $Message -MessageLevel $MessageLevel\n    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException\n    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Write-Log\n</code></pre>\n\nHas someone an idea how to fix this?<br />\n<br />\nGreetings<br />\nAndre<br />\n",
    "PostedDate": "2013-08-02T04:11:20.06-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1077914",
    "ThreadId": "452217",
    "Html": "Hi Andre,\r<br />\nI recommend specifying the node names for the -ComputerName parameter rather than the cluster name. During the service discovery phase SQL Power Doc will check to see if the service is part of a cluster; if so it will connect to the cluster name to gather configuration details for the database engine and connect to each individual machine to gather OS details.\r<br />\n<br />\n--Kendal<br />\n",
    "PostedDate": "2013-08-07T12:19:55.9-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1077979",
    "ThreadId": "452217",
    "Html": "Hi Kendal,\r<br />\n<br />\ngreat... thanks for your response.\r<br />\nI will try it tomorrow and will Report the results.\r<br />\n<br />\nThanks a lot,\r<br />\n<br />\nAndre<br />\n",
    "PostedDate": "2013-08-07T14:17:02.81-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1078132",
    "ThreadId": "452217",
    "Html": "Hi Kendal,<br />\n<br />\nchecked your solution for this problem, but unfortunately it will not work.<br />\nI attached you the error from the verbose.log.<br />\n<pre><code>2013-08-08 09:07:26.7377 ? Beginning scan of 1 instance(s)\n2013-08-08 09:07:26.9008 ? Gathering information from ACTIVENODE [Instance 1 of 1]\n2013-08-08 09:07:56.7193 + Failed to connect to ACTIVENODE \n2013-08-08 09:07:56.7271 + Failed to connect to ACTIVENODE \n2013-08-08 09:07:56.7330 + Failed to connect to ACTIVENODE \n2013-08-08 09:07:56.7398 + [ACTIVENODE ] Error gathering instance information - max error threshold reached (3)\n2013-08-08 09:07:56.9713 ! Failed to scan ACTIVENODE -  3 errors\n2013-08-08 09:07:57.2574 ? Instance scan complete (Success: 0; Failure: 1)</code></pre>\n\nScript call:<br />\n<pre><code>.\\Get-SqlServerInventoryToClixml.ps1 -ComputerName ACTIVENODE,PASSIVENODE</code></pre>\n\nCheers<br />\nAndre<br />\n",
    "PostedDate": "2013-08-08T02:18:38.53-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1078392",
    "ThreadId": "452217",
    "Html": "Andre,\r<br />\nWhat version of SQL Server and Windows is your cluster running?\r<br />\n<br />\nStupid question, but are you able to connect to your cluster using SSMS from the same machine that SQL Power Doc is running from?\r<br />\n<br />\n--Kendal<br />\n",
    "PostedDate": "2013-08-08T12:21:16.823-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1078422",
    "ThreadId": "452217",
    "Html": "Hi Kendal,\r<br />\n<br />\nSQL Server is 2008 SP3 CU11 and 2008R2 SP2. The Windows Versions are Windows Server 2008 R2.\r<br />\n<br />\nI can connect to the Cluster Instances via SSMS and SQLCMD. For sure, only when I will use the virtual node name, or the IP-Adress of the cluster ressource, not when I'm using the hostname of the  cluster node on which the instance is active at the moment. Also the user has sysadmins rights on SQL Server and administrator rights on windows.\r<br />\n<br />\nCheers \r<br />\nAndre<br />\n",
    "PostedDate": "2013-08-08T13:07:41.513-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1078467",
    "ThreadId": "452217",
    "Html": "What I'm seeing from the example call that you posted + log data + details about versions of Windows that you're running is that the discovery piece of SQL Power Doc found the clustered instance but isn't properly resolving the cluster name.\r<br />\n<br />\nWould you mind running the code below (changing the value for $ActiveNodeName to match your active node name) on the same server where you're running SQL Power Doc and paste the results (with names &amp; accounts in the results renamed/redacted to protect the innocent) here for me?<br />\n<pre><code>$ActiveNodeName = 'ACTIVENODE'\n\n\n# Load SMO Assemblies\n[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMO') | ForEach-Object {\n    if ($_.GetName().Version.Major -ge 10) {\n        [System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMOExtended') | Out-Null\n        [System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SQLWMIManagement') | Out-Null\n    }\n}\n\n\n# Connect to the server using the ManagedComputer object\n$ManagedComputer = New-Object -TypeName 'Microsoft.SqlServer.Management.Smo.Wmi.ManagedComputer' -ArgumentList $ActiveNodeName\n\n\n# Iterate through each SQL Server service and determine if it's clustered (and what the cluster name is)\n$ManagedComputer.Services | ForEach-Object {\n\n    # Initialize variables\n    $IsClusteredInstance = $false\n    $DomainName = $null\n    $ClusterName = $null\n    $FQClusterName = $null\n    $ServiceIpAddress = $null\n\n    try {\n\n        if ($_.AdvancedProperties['CLUSTERED'].Value -eq $true) {\n\n            $IsClusteredInstance = $true\n\n            Get-WmiObject -Namespace root\\CIMV2 -Class Win32_ComputerSystem -Property Domain -ComputerName $ActiveNodeName -ErrorAction Stop | ForEach-Object {\n                $DomainName = $_.Domain\n            }\n\n            $ClusterName = $_.AdvancedProperties['VSNAME'].Value\n            $FQClusterName = [String]::Join('.', @($_.AdvancedProperties['VSNAME'].Value, $DomainName)).ToUpper()\n\n            [System.Net.Dns]::GetHostByName($ClusterName) | ForEach-Object {\n                $_.AddressList | Where-Object { $_.AddressFamily -ieq 'InterNetwork' } | ForEach-Object {\n                    $ServiceIpAddress = $_.IPAddressToString\n                }\n            }\n\n        } else {\n            $IsClusteredInstance = $false\n            $ClusterName = 'NOT A CLUSTERED SERVICE'\n        }\n    }\n    catch {\n        $IsClusteredInstance = $false\n        $ClusterName = 'ERROR RESOLVING CLUSTER NAME'\n    }\n\n\n    New-Object -TypeName PSObject -Property @{\n        ComputerName = $ActiveNodeName\n        DisplayName = $_.DisplayName\n        Description = $_.Description\n        IsClusteredInstance = $IsClusteredInstance\n        ClusterName = $ClusterName\n        FQClusterName = $FQClusterName\n        AdvancedProperties = $_.AdvancedProperties\n    }\n    \n} | Format-List -Property *\n\nRemove-Variable -Name ActiveNodeName, ManagedComputer, IsClusteredInstance, DomainName, ClusterName, FQClusterName, ServiceIpAddress\n</code></pre>\n\nThanks,\r<br />\nKendal<br />\n",
    "PostedDate": "2013-08-08T14:48:29.313-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1084704",
    "ThreadId": "452217",
    "Html": "Hi Kendal,\r<br />\n<br />\nsorry for the late response. The last days were very busy, but now my vacation starts. :)\r<br />\n<br />\nHere is the result of the script:<br />\n<pre><code>IsClusteredInstance : False\nDisplayName         : SQL Server Integration Services 10.0\nAdvancedProperties  : {}\nClusterName         : NOT A CLUSTERED SERVICE\nComputerName        : ACTIVENODE\nDescription         : Provides management support for SSIS package storage and execution.\nFQClusterName       :\n\nIsClusteredInstance : False\nDisplayName         : SQL Full-text Filter Daemon Launcher (MSSQLSERVER)\nAdvancedProperties  : {}\nClusterName         : NOT A CLUSTERED SERVICE\nComputerName        : ACTIVENODE\nDescription         : Service to launch full-text filter daemon process which will perform document filtering and word\n                      breaking for SQL Server full-text search. Disabling this service will make full-text search featu\n                      res of SQL Server unavailable.\nFQClusterName       :\n\nIsClusteredInstance : True\nDisplayName         : SQL Server (MSSQLSERVER)\nAdvancedProperties  : {Name=CLUSTERED/Type=System.Boolean/Writable=False/Value=True, Name=DATAPATH/Type=System.String/W\n                      ritable=False/Value=F:\\MSSQL10.MSSQLSERVER\\MSSQL, Name=DUMPDIR/Type=System.String/Writable=True/V\n                      alue=F:\\MSSQL10.MSSQLSERVER\\MSSQL\\LOG\\, Name=ERRORREPORTING/Type=System.Boolean/Writable=True/Val\n                      ue=False...}\nClusterName         : CLUSTERNAME\nComputerName        : ACTIVENODE\nDescription         : Provides storage, processing and controlled access of data, and rapid transaction processing.\nFQClusterName       : CLUSTERNAME.FQDN.COM\n\nIsClusteredInstance : True\nDisplayName         : SQL Server Analysis Services (default)\nAdvancedProperties  : {Name=CLUSTERED/Type=System.Boolean/Writable=False/Value=True, Name=DUMPDIR/Type=System.String/Wr\n                      itable=True/Value=g:\\OLAP\\Log, Name=ERRORREPORTING/Type=System.Boolean/Writable=True/Value=False,\n                       Name=INSTANCEID/Type=System.String/Writable=False/Value=MSAS10.MSSQLSERVER...}\nClusterName         : CLUSTERNAME\nComputerName        : ACTIVENODE\nDescription         : Supplies online analytical processing (OLAP) and data mining functionality for business intellige\n                      nce applications.\nFQClusterName       : CLUSTERNAME.FQDN.COM\n\nIsClusteredInstance : True\nDisplayName         : SQL Server Browser\nAdvancedProperties  : {Name=BROWSER/Type=System.Boolean/Writable=True/Value=True, Name=CLUSTERED/Type=System.Boolean/Wr\n                      itable=False/Value=True, Name=DUMPDIR/Type=System.String/Writable=True/Value=g:\\OLAP\\Log, Name=ER\n                      RORREPORTING/Type=System.Boolean/Writable=True/Value=False...}\nClusterName         :\nComputerName        : ACTIVENODE\nDescription         : Provides SQL Server connection information to client computers.\nFQClusterName       : .FQDN.COM\n\nIsClusteredInstance : True\nDisplayName         : SQL Server Agent (MSSQLSERVER)\nAdvancedProperties  : {Name=CLUSTERED/Type=System.Boolean/Writable=False/Value=True, Name=DUMPDIR/Type=System.String/Wr\n                      itable=True/Value=F:\\MSSQL10.MSSQLSERVER\\MSSQL\\LOG\\, Name=ERRORREPORTING/Type=System.Boolean/Writ\n                      able=True/Value=False, Name=INSTANCEID/Type=System.String/Writable=False/Value=MSSQL10.MSSQLSERVE\n                      R...}\nClusterName         : CLUSTERNAME\nComputerName        : ACTIVENODE\nDescription         : Executes jobs, monitors SQL Server, fires alerts, and allows automation of some administrative ta\n                      sks.\nFQClusterName       : CLUSTERNAME.FQDN.COM</code></pre>\n\nThanks\r<br />\nAndre<br />\n",
    "PostedDate": "2013-08-25T13:27:58.863-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1109939",
    "ThreadId": "452217",
    "Html": "Hi Kendal,\r<br />\n<br />\nchecked you new SQL Power Doc a few hours ago.\r<br />\nJust want to tell you that it is not working properly with SQL Server Clusters.\r<br />\n<br />\nGreetings,\r<br />\n<br />\nAndre<br />\n",
    "PostedDate": "2013-10-21T04:43:17.403-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110024",
    "ThreadId": "452217",
    "Html": "Andre,\r<br />\nThanks - I'm getting the same error. DOH!\r<br />\n<br />\nWorking on a fix for it today and will post a new version as soon as I can.\r<br />\n<br />\n--Kendal<br />\n",
    "PostedDate": "2013-10-21T07:47:30.747-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110109",
    "ThreadId": "452217",
    "Html": "Andre, I'm getting an error when running the scripts on a machine that's NOT in the same domain as the cluster, but when running on a machine inside the domain (that's not one of the clustered servers) the scripts work for me. Are you by any chance running the scripts in a similar scenario?\r<br />\n<br />\n--Kendal<br />\n",
    "PostedDate": "2013-10-21T10:24:27.783-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110173",
    "ThreadId": "452217",
    "Html": "Kendal,\r<br />\n<br />\nI tried to run the script from a workstation that is joined the same domain as the cluster. Also I tried to run the scripts against more than cluster in the same domain, everytime the same error.\r<br />\nIt seems to be the same Problem as before, but let me describe it again:\r<br />\n<br />\nImagine we are on a workstation and we want to run the script against a cluster in the same domain. The cluster resource group has the NetBIOS name CLUSTER01 which is build upon the nodes NODE01 and NODE02.\r<br />\n<br />\nI ran the script like this. .\\Convert-SqlServerInventoryClixmlToExcel.ps1 -ComputerName CLUSTER01\r<br />\n<br />\nFirst it seems to run normally, but after a few seconds the script stops with the following error:<br />\n<pre><code>WARNING: Failed to connect to NODE01\nWARNING: Failed to connect to NODE01\nWARNING: Failed to connect to NODE01\nWARNING: [NODE01] Error gathering instance information - max error threshold reached (3)\nWrite-Log : Failed to scan NODE01 -  3 errors\nAt C:\\Users\\User01\\Documents\\WindowsPowerShell\\Modules\\SqlServerInventory\\SqlServerInventory.psm1:275 char:13\n+             Write-Log &lt;&lt;&lt;&lt;  -Message $Message -MessageLevel $MessageLevel\n    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException\n    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Write-Log</code></pre>\n\nSo, after connecting to the NetBIOS name of the Cluster Ressource CLUSTER01, the script will not use the cluster name to connect to the SQL instance, instead it tries to use the NetBIOS name of the active node NODE01. That is not working, because in the cluster environment the SQL instance is listening only on the IP and NetBIOS name of the cluster resource.\r<br />\n<br />\nSo, to shorten that a bit, why is your scripting trying to connect to the active node and not to the cluster itself?\r<br />\n<br />\nGreetings,\r<br />\nAndre<br />\n",
    "PostedDate": "2013-10-21T11:59:34.81-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110249",
    "ThreadId": "452217",
    "Html": "Hi Andre,\r<br />\nThe script <em>should</em> try to connect to the cluster name and not each node name. My test setup consists of an AD controller, SAN, and 2 SQL Server instances all running in virtual machines. Each VM is running Windows 2008 R2 Enterprise Edition and the SQL Servers are 2008 R2 Developer Edition. It sounds like we've got a similar setup but I can't reproduce the error you're seeing (yet). \r<br />\n<br />\nThe sample output that you posted on Aug 25 shows that the instance is being detected as clustered so something else is happening here...\r<br />\n<br />\nWould you mind running the following on the same machine where you've got the SQL Power Doc scripts and posting the (cleansed) output for me? (of course make sure to put the proper node names in here first).<br />\n<pre><code>Import-Module -Name NetworkScan\nFind-SqlServerService -ComputerName ACTIVENODE,PASSIVENODE | Format-List -Property *\nRemove-Module -Name NetworkScan</code></pre>\n\n--Kendal<br />\n",
    "PostedDate": "2013-10-21T14:19:44.44-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110387",
    "ThreadId": "452217",
    "Html": "Good Morning Kendal,<br />\n<br />\nI ran this script a few minutes ago:<br />\n<pre><code>Import-Module -Name NetworkScan\nFind-SqlServerService -ComputerName ACTIVENODE,PASSIVENODE | Format-List -Property *\nRemove-Module -Name NetworkScan</code></pre>\n\nAnd I got this result back:<br />\n<pre><code>ServiceAccount      : NT AUTHORITY\\LOCAL SERVICE\nServiceStartDate    : 29.09.2013 11:38:44\nProcessId           : 7068\nStartupParameters   :\nServiceProtocols    :\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Service to launch full-text filter daemon process which will perform document filtering and word\n                      breaking for SQL Server full-text search. Disabling this service will make full-text search featu\n                      res of SQL Server unavailable.\nIsHadrEnabled       :\nDisplayName         : SQL Full-text Filter Daemon Launcher (MSSQLSERVER)\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Full-text Filter Daemon Launcher\nComputerIpAddress   : 10.250.7.200\nStartMode           : Manual\nPort                :\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\fdlauncher.exe&quot; -s MSSQL10.\n                      MSSQLSERVER\n\n\nServiceAccount      : DOMAIN\\SERVICEACCOUNT\nServiceStartDate    : 29.09.2013 11:38:41\nProcessId           : 9072\nStartupParameters   : -dF:\\MSSQL10.MSSQLSERVER\\MSSQL\\DATA\\master.mdf;-eF:\\MSSQL10.MSSQLSERVER\\MSSQL\\Log\\ERRORLOG;-lF:\\M\n                      SSQL10.MSSQLSERVER\\MSSQL\\DATA\\mastlog.ldf;-T1117\nServiceProtocols    : {@{IsEnabled=True; Name=Np; DisplayName=Named Pipes; ProtocolProperties=System.Collections.Hashta\n                      ble; IPAddresses=}, @{IsEnabled=True; Name=Sm; DisplayName=Shared Memory; ProtocolProperties=Syst\n                      em.Collections.Hashtable; IPAddresses=}, @{IsEnabled=True; Name=Tcp; DisplayName=TCP/IP; Protocol\n                      Properties=System.Collections.Hashtable; IPAddresses=System.Object[]}, @{IsEnabled=False; Name=Vi\n                      a; DisplayName=VIA; ProtocolProperties=System.Collections.Hashtable; IPAddresses=}}\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       : False\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Provides storage, processing and controlled access of data, and rapid transaction processing.\nIsHadrEnabled       :\nDisplayName         : SQL Server (MSSQLSERVER)\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Server\nComputerIpAddress   : 10.250.7.200\nStartMode           : Manual\nPort                : 1433\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\sqlservr.exe&quot; -sMSSQLSERVER\n\n\nServiceAccount      : NT AUTHORITY\\LOCAL SERVICE\nServiceStartDate    : 29.09.2013 11:34:12\nProcessId           : 2472\nStartupParameters   :\nServiceProtocols    :\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Provides SQL Server connection information to client computers.\nIsHadrEnabled       :\nDisplayName         : SQL Server Browser\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Server Browser\nComputerIpAddress   : 10.250.7.200\nStartMode           : Auto\nPort                :\nPathName            : &quot;C:\\Program Files (x86)\\Microsoft SQL Server\\90\\Shared\\sqlbrowser.exe&quot;\n\n\nServiceAccount      : DOMAIN\\SERVICEACCOUNT\nServiceStartDate    : 29.09.2013 11:38:45\nProcessId           : 6812\nStartupParameters   :\nServiceProtocols    :\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Executes jobs, monitors SQL Server, fires alerts, and allows automation of some administrative tasks.\nIsHadrEnabled       :\nDisplayName         : SQL Server Agent (MSSQLSERVER)\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Server Agent\nComputerIpAddress   : 10.250.7.200\nStartMode           : Manual\nPort                :\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\SQLAGENT.EXE&quot; -i MSSQLSERVER\n\n\nServiceAccount      : NT AUTHORITY\\LOCAL SERVICE\nServiceStartDate    :\nProcessId           : 0\nStartupParameters   :\nServiceProtocols    :\nServerName          : PASSIVE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Stopped\nServiceIpAddress    :\nDescription         : Service to launch full-text filter daemon process which will perform document filtering and word\n                      breaking for SQL Server full-text search. Disabling this service will make full-text search featu\n                      res of SQL Server unavailable.\nIsHadrEnabled       :\nDisplayName         : SQL Full-text Filter Daemon Launcher (MSSQLSERVER)\nComputerName        : PASSIVE.DOMAIN.TLD\nServiceTypeName     : SQL Full-text Filter Daemon Launcher\nComputerIpAddress   : 10.250.7.201\nStartMode           : Manual\nPort                :\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\fdlauncher.exe&quot; -s MSSQL10.\n                      MSSQLSERVER\n\n\nServiceAccount      : DOMAIN\\SERVICEACCOUNT\nServiceStartDate    :\nProcessId           : 0\nStartupParameters   : -dF:\\MSSQL10.MSSQLSERVER\\MSSQL\\DATA\\master.mdf;-eF:\\MSSQL10.MSSQLSERVER\\MSSQL\\Log\\ERRORLOG;-lF:\\M\n                      SSQL10.MSSQLSERVER\\MSSQL\\DATA\\mastlog.ldf;-T1117\nServiceProtocols    : {@{IsEnabled=True; Name=Np; DisplayName=Named Pipes; ProtocolProperties=System.Collections.Hashta\n                      ble; IPAddresses=}, @{IsEnabled=True; Name=Sm; DisplayName=Shared Memory; ProtocolProperties=Syst\n                      em.Collections.Hashtable; IPAddresses=}, @{IsEnabled=True; Name=Tcp; DisplayName=TCP/IP; Protocol\n                      Properties=System.Collections.Hashtable; IPAddresses=System.Object[]}, @{IsEnabled=False; Name=Vi\n                      a; DisplayName=VIA; ProtocolProperties=System.Collections.Hashtable; IPAddresses=}}\nServerName          : PASSIVE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       : False\nIsClusteredInstance : False\nServiceState        : Stopped\nServiceIpAddress    :\nDescription         : Provides storage, processing and controlled access of data, and rapid transaction processing.\nIsHadrEnabled       :\nDisplayName         : SQL Server (MSSQLSERVER)\nComputerName        : PASSIVE.DOMAIN.TLD\nServiceTypeName     : SQL Server\nComputerIpAddress   : 10.250.7.201\nStartMode           : Manual\nPort                : 1433\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\sqlservr.exe&quot; -sMSSQLSERVER\n\n\nServiceAccount      : NT AUTHORITY\\LOCAL SERVICE\nServiceStartDate    : 29.09.2013 11:50:14\nProcessId           : 3152\nStartupParameters   :\nServiceProtocols    :\nServerName          : PASSIVE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Provides SQL Server connection information to client computers.\nIsHadrEnabled       :\nDisplayName         : SQL Server Browser\nComputerName        : PASSIVE.DOMAIN.TLD\nServiceTypeName     : SQL Server Browser\nComputerIpAddress   : 10.250.7.201\nStartMode           : Auto\nPort                :\nPathName            : &quot;C:\\Program Files (x86)\\Microsoft SQL Server\\90\\Shared\\sqlbrowser.exe&quot;\n\n\nServiceAccount      : DOMAIN\\SERVICEACCOUNT\nServiceStartDate    :\nProcessId           : 0\nStartupParameters   :\nServiceProtocols    :\nServerName          : PASSIVE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Stopped\nServiceIpAddress    :\nDescription         : Executes jobs, monitors SQL Server, fires alerts, and allows automation of some administrative ta\n                      sks.\nIsHadrEnabled       :\nDisplayName         : SQL Server Agent (MSSQLSERVER)\nComputerName        : PASSIVE.DOMAIN.TLD\nServiceTypeName     : SQL Server Agent\nComputerIpAddress   : 10.250.7.201\nStartMode           : Manual\nPort                :\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\SQLAGENT.EXE&quot; -i MSSQLSERVE\n                      R</code></pre>\n\nI also let this script run against the Cluster:<br />\n<pre><code>Import-Module -Name NetworkScan\nFind-SqlServerService -ComputerName CLUSTERRESSOURCENAME | Format-List -Property *\nRemove-Module -Name NetworkScan</code></pre>\n\n",
    "PostedDate": "2013-10-22T00:06:58.167-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110388",
    "ThreadId": "452217",
    "Html": "And I got that back:<br />\n<pre><code>ServiceAccount      : NT AUTHORITY\\LOCAL SERVICE\nServiceStartDate    : 29.09.2013 11:38:44\nProcessId           : 7068\nStartupParameters   :\nServiceProtocols    :\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Service to launch full-text filter daemon process which will perform document filtering and word\n                      breaking for SQL Server full-text search. Disabling this service will make full-text search featu\n                      res of SQL Server unavailable.\nIsHadrEnabled       :\nDisplayName         : SQL Full-text Filter Daemon Launcher (MSSQLSERVER)\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Full-text Filter Daemon Launcher\nComputerIpAddress   : 10.250.7.204\nStartMode           : Manual\nPort                :\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\fdlauncher.exe&quot; -s MSSQL10.\n                      MSSQLSERVER\n\nServiceAccount      : DOMAIN\\SERVICEACCOUNT\nServiceStartDate    : 29.09.2013 11:38:41\nProcessId           : 9072\nStartupParameters   : -dF:\\MSSQL10.MSSQLSERVER\\MSSQL\\DATA\\master.mdf;-eF:\\MSSQL10.MSSQLSERVER\\MSSQL\\Log\\ERRORLOG;-lF:\\M\n                      SSQL10.MSSQLSERVER\\MSSQL\\DATA\\mastlog.ldf;-T1117\nServiceProtocols    : {@{IsEnabled=True; Name=Np; DisplayName=Named Pipes; ProtocolProperties=System.Collections.Hashta\n                      ble; IPAddresses=}, @{IsEnabled=True; Name=Sm; DisplayName=Shared Memory; ProtocolProperties=Syst\n                      em.Collections.Hashtable; IPAddresses=}, @{IsEnabled=True; Name=Tcp; DisplayName=TCP/IP; Protocol\n                      Properties=System.Collections.Hashtable; IPAddresses=System.Object[]}, @{IsEnabled=False; Name=Vi\n                      a; DisplayName=VIA; ProtocolProperties=System.Collections.Hashtable; IPAddresses=}}\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       : False\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Provides storage, processing and controlled access of data, and rapid transaction processing.\nIsHadrEnabled       :\nDisplayName         : SQL Server (MSSQLSERVER)\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Server\nComputerIpAddress   : 10.250.7.204\nStartMode           : Manual\nPort                : 1433\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\sqlservr.exe&quot; -sMSSQLSERVER\n\nServiceAccount      : NT AUTHORITY\\LOCAL SERVICE\nServiceStartDate    : 29.09.2013 11:34:12\nProcessId           : 2472\nStartupParameters   :\nServiceProtocols    :\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Provides SQL Server connection information to client computers.\nIsHadrEnabled       :\nDisplayName         : SQL Server Browser\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Server Browser\nComputerIpAddress   : 10.250.7.204\nStartMode           : Auto\nPort                :\nPathName            : &quot;C:\\Program Files (x86)\\Microsoft SQL Server\\90\\Shared\\sqlbrowser.exe&quot;\n\nServiceAccount      : DOMAIN\\SERVICEACCOUNT\nServiceStartDate    : 29.09.2013 11:38:45\nProcessId           : 6812\nStartupParameters   :\nServiceProtocols    :\nServerName          : ACTIVENODE.DOMAIN.TLD\nIsNamedInstance     : False\nIsDynamicPort       :\nIsClusteredInstance : False\nServiceState        : Running\nServiceIpAddress    :\nDescription         : Executes jobs, monitors SQL Server, fires alerts, and allows automation of some administrative ta\n                      sks.\nIsHadrEnabled       :\nDisplayName         : SQL Server Agent (MSSQLSERVER)\nComputerName        : ACTIVENODE.DOMAIN.TLD\nServiceTypeName     : SQL Server Agent\nComputerIpAddress   : 10.250.7.204\nStartMode           : Manual\nPort                :\nPathName            : &quot;D:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\SQLAGENT.EXE&quot; -i MSSQLSERVE\n                      R</code></pre>\n\nHope that can help you to find the problem and a solution for this.\r<br />\n<br />\nThanks\r<br />\n<br />\nAndre<br />\n",
    "PostedDate": "2013-10-22T00:07:55.53-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110722",
    "ThreadId": "452217",
    "Html": "Hi Andre,\r<br />\nThanks for being so patient (and helpful) with figuring this out. I <em>think</em> (crossing my fingers) I know where the specific problem is occurring. Would you run one more thing for me? This should be run in a PowerShell console on the same machine where you're running SQL Power Doc and using the same credentials:<br />\n<pre><code>[System.Net.Dns]::GetHostByName('CLUSTERNAME.FQDN.COM')</code></pre>\n\n(Obviously, replace CLUSTERNAME.FQDN.COM with the FQDN of your cluster). What I'm expecting/hoping to see is an error returned, rather than a successful call. From what I can see in my code, if this fails then that could cause the service to be marked as NOT part of a cluster and an attempt to connect to it on the node name rather than the cluster name.\r<br />\n<br />\n--Kendal<br />\n",
    "PostedDate": "2013-10-22T11:53:06.947-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1110931",
    "ThreadId": "452217",
    "Html": "Hi Kendal,\r<br />\n<br />\nyou are welcome, I just want to Help you and the community to get a great product.\r<br />\n<br />\nI just executed your command in the PowerShell and get the following results<br />\n<pre><code>PS C:\\&gt; [System.Net.Dns]::GetHostByName('CLUSTERNAME.FQDN.COM')\n\nHostName                                Aliases                                 AddressList\n--------                                -------                                 -----------\nCLUSTERNAME.FQDN.COM                    {}                                      {10.1.1.25}</code></pre>\n\nThe IP 10.1.1.25 is the IP of the Cluster ressource.\r<br />\n<br />\nGreetings\r<br />\nAndre<br />\n",
    "PostedDate": "2013-10-23T01:45:26.687-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1133681",
    "ThreadId": "452217",
    "Html": "Hello Kendal,\r<br />\n<br />\nI was in an urgent need to document 20+ SQL Servers and was very, very happy to find this because it did exactly what I need - except it didn't work on a SQL Cluster.\r<br />\n<br />\nSo I tried around a little bit (without changing a single bit of the code) and ended up with starting the script remotely using the following command:\r<br />\n<br />\n'Get-SqlServerInventoryToClixml.ps1 -Computername NODE_A,NODE_B -LoggingPreference Debug'\r<br />\n<br />\nGuess what: It worked! Even it did not when running directly on a cluster node or when using '-LoggingPreference Standard' (I didn't try 'Verbose').\r<br />\n<br />\nI just wanted to let you know about this behavior, and also to say thank you for your great work.\r<br />\n<br />\nGreetings,\r<br />\nSam<br />\n",
    "PostedDate": "2013-12-10T09:28:05.29-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1319611",
    "ThreadId": "452217",
    "Html": "I acually had the same problem in my cluster.. Or... I could document a few sql instances. I discovered that Dynamic port and TCP port was enabled in TCP/IP configuration for each instance in SQL Configuration Manager. When I &quot;disabled&quot; TCP port, the script went through. \r<br />\n<br />\nThank you for a great script!\r<br />\n<br />\nCheers,<br />\n",
    "PostedDate": "2014-11-06T03:35:36.49-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1320641",
    "ThreadId": "452217",
    "Html": "Management says no to disabling TCP ports....is there any way to simply use the cluster name and have the script do all the behind the scenes work.....really, really want/need to use the script for sql inventory......any help would be greatly appreciated....thanks in advance.......<br />\n",
    "PostedDate": "2014-11-10T10:55:19.323-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1320955",
    "ThreadId": "452217",
    "Html": "Sam, 97marno, &amp; wjbergen: You <em>should</em> be able to document a cluster without having to do anything special; you just need to provide either the names of the nodes in the cluster or the cluster name itself for the -computername parameter. (I recommend the node names because you'll get service configuration details from each, whereas if you provide the cluster name you'll only get details about the node the cluster is active on)\r<br />\n<br />\nI tested this out in my VM lab and was able to document my cluster both by cluster name and by individual machine names without having to disable TCP/IP or any other workarounds. Based on this it seems like something about my test setup is different than your environment, so I have a few questions:<br />\n<ul>\n<li>What version of SQL Power Doc are you running?</li>\n<li>What version of SMO do you have installed?</li>\n<li>Are you running the SQL Power Doc scripts on one of the cluster nodes or are the scripts running on a machine that's not part of the cluster? (note, I mean I want to know the machine the scripts are running <em>on</em>, not the machine(s) the scripts are running <em>against</em>)</li>\n<li>\nIs your cluster a default instance or a named instance?<br />\n</li>\n</ul>\nA few more details and I'm sure we'll get to the bottom of what's going on here...\r<br />\n<br />\nKendal<br />\n",
    "PostedDate": "2014-11-11T08:49:29.45-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]