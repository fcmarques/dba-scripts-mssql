[
  {
    "Id": "1231906",
    "ThreadId": "541606",
    "Html": "Hi Kendal,\r<br />\n<br />\nAttended your CLE SQL Saturday presentation few months ago. Impressed by product and amount of information reported. Using on multiple servers, but having issue with one running SQL Server 2005, SP2. Verified the SMO component installed. My question is are there minimum service packs for each of the SQL releases? Getting the following error:\r<br />\n<br />\n2014-04-08 09:56:34.9713 ? Beginning SQL Server Inventory\r<br />\n2014-04-08 09:56:35.0643 ? \t-LoggingPreference: Verbose\r<br />\n2014-04-08 09:56:35.0703 ? \t-ComputerName: &lt;my computer&gt;\r<br />\n2014-04-08 09:56:35.0753 ? \t-MaxConcurrencyThrottle: 6\r<br />\n2014-04-08 09:56:35.0803 ? \t-PrivateOnly: False\r<br />\n2014-04-08 09:56:35.0843 ? \t-ParentProgressId: -1\r<br />\n2014-04-08 09:56:35.0893 ? \t-IncludeDatabaseObjectPermissions: False\r<br />\n2014-04-08 09:56:35.0933 ? \t-IncludeDatabaseObjectInformation: True\r<br />\n2014-04-08 09:56:35.0973 ? \t-IncludeDatabaseSystemObjects: False\r<br />\n2014-04-08 09:56:35.1103 ? Beginning network scan\r<br />\n2014-04-08 09:56:35.1153 ? \t-ComputerName: &lt;my computer&gt;\r<br />\n2014-04-08 09:56:35.1203 ? \t-PrivateOnly: False\r<br />\n2014-04-08 09:56:35.1243 ? \t-MaxConcurrencyThrottle: 6\r<br />\n2014-04-08 09:56:35.1293 ? \t-ResolveAliases: True\r<br />\n2014-04-08 09:56:35.1373 ? Resolving IP address for &lt;my computer&gt;\r<br />\n2014-04-08 09:56:35.2973 ? Testing PING connectivity to 1 addresses\r<br />\n2014-04-08 09:56:35.3063 $ Testing PING connectivity to &lt;my computer&gt; [1 of 1]\r<br />\n2014-04-08 09:56:37.3925 $ PING response from &lt;my computer&gt;True\r<br />\n2014-04-08 09:56:37.6606 $ PING connectivity test complete\r<br />\n2014-04-08 09:56:37.6796 ? Testing WMI connectivity to 1 addresses\r<br />\n2014-04-08 09:56:37.6886 $ Testing WMI connectivity to &lt;my computer&gt; [1 of 1]\r<br />\n2014-04-08 09:56:37.9486 $ WMI response from &lt;my computer&gt; (&lt;my IP address&gt;): True\r<br />\n2014-04-08 09:56:38.2116 $ WMI connectivity test complete\r<br />\n2014-04-08 09:56:38.2236 ? Network scan complete\r<br />\n2014-04-08 09:56:38.2286 ? \t-IP Addresses Scanned: 1\r<br />\n2014-04-08 09:56:38.2326 ? \t-PING Replies: 1\r<br />\n2014-04-08 09:56:38.2386 ? \t-WMI Replies: 1\r<br />\n2014-04-08 09:56:38.2476 ? Beginning SQL Service discovery scan\r<br />\n2014-04-08 09:56:38.3246 ? Scanning &lt;my computer&gt; at IP address &lt;my IP address&gt; for SQL Services [Device 1 of 1]\r<br />\n2014-04-08 09:56:39.1087 ? ERROR: Unable to retrieve service information from &lt;my computer&gt; (&lt;my IP address&gt;Exception calling &quot;EndInvoke&quot; with &quot;1&quot; argument(s): &quot;The following exception was thrown when trying to enumerate the collection: &quot;An exception occurred in SMO while trying to manage a service.&quot;.&quot;\r<br />\n2014-04-08 09:56:39.3797 ? SQL Server service discovery complete\r<br />\n2014-04-08 09:56:39.3877 ? Beginning scan of 0 instance(s)\r<br />\n2014-04-08 09:56:39.7198 ? Instance scan complete (Success: 0; Failure: 0)\r<br />\n2014-04-08 09:56:39.7308 ? Writing Inventory to disk\r<br />\n2014-04-08 09:56:39.7348 + No machines found!<br />\n",
    "PostedDate": "2014-04-08T07:51:30.887-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1234373",
    "ThreadId": "541606",
    "Html": "Good question! I haven't run a full set of tests to see if there's a problem with an older version of SMO connecting to a newer version of SQL Server so it's <em>possible</em> that there could be an issue, e.g. SMO 2005 connecting to a 2012 server.\r<br />\n<br />\nGenerally speaking you want to make sure that you're running a version of SMO that matches the highest version of SQL server in your environment. If you're doing that and still running into this error then there's likely a different issue at play here, e.g. permissions. You can put that to the test by running this snippet of code in an ISE window (make sure to update with the correct server name):<br />\n<pre><code># Load SMO Assemblies\n[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMO') | ForEach-Object {\n if ($_.GetName().Version.Major -ge 10) {\n  [System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMOExtended') | Out-Null\n   [System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SQLWMIManagement') | Out-Null\n }\n}\n\n$error.Clear()\n$ManagedComputer = New-Object -TypeName 'Microsoft.SqlServer.Management.Smo.Wmi.ManagedComputer' -ArgumentList 'COMPUTERNAME.DOMAIN.COM'\n$ManagedComputer.Services | Format-Table -Property DisplayName, StartMode, ServiceState, ProcessId\nRemove-Variable -Name ManagedComputer\n$Error</code></pre>\n\n<h2>If everything's working you should see a table of services returned. Let me know if that's the case and we'll try the next step in troubleshooting.</h2>\nKendal<br />\n",
    "PostedDate": "2014-04-15T09:11:29.277-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]